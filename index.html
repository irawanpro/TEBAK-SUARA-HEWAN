<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tebak Suara Hewan!</title>
    <style>
        /* Desain Umum dan Font */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Open+Sans:wght@400;700&display=swap');

        body {
            font-family: 'Open Sans', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); /* Gradien cerah */
            color: #333;
            overflow-x: hidden; /* Mencegah scroll horizontal */
        }

        .game-container {
            background-color: #fff;
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            padding: 40px;
            text-align: center;
            max-width: 650px;
            width: 90%;
            transform: scale(0.95);
            animation: bounceIn 0.8s ease-out forwards;
            position: relative;
            overflow: hidden;
            border: 5px solid #FF6347; /* Border menarik */
            box-sizing: border-box; /* Pastikan padding masuk dalam lebar */
        }

        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        /* Hiasan Latar Belakang (Opsional) */
        .game-container::before, .game-container::after {
            content: '';
            position: absolute;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            filter: blur(20px);
            z-index: 0;
        }

        .game-container::before {
            width: 150px;
            height: 150px;
            top: -50px;
            left: -50px;
        }

        .game-container::after {
            width: 100px;
            height: 100px;
            bottom: -30px;
            right: -30px;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            color: #FF6347;
            margin-bottom: 25px;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .volume-control {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 10;
        }

        .volume-control label {
            font-family: 'Fredoka One', cursive;
            font-size: 1.1em;
            color: #555;
        }

        .volume-control input[type="range"] {
            -webkit-appearance: none;
            width: 100px;
            height: 8px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }

        .volume-control input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .volume-control input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .current-question-info {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2em;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .score-display {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5em;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .question-mark-display {
            font-size: 8em;
            background-color: #333;
            color: white;
            border-radius: 50%;
            width: 1.5em;
            height: 1.5em;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px auto;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            animation: pulse 1.5s infinite alternate;
            line-height: 1;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        .question-mark-display:hover {
            transform: scale(1.1);
        }

        .instructions-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            gap: 10px;
        }

        .instructions-text {
            font-style: italic;
            color: #555;
            font-size: 1.1em;
            margin: 0;
        }

        .instruction-button {
            background-color: #1E90FF;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .instruction-button:hover {
            background-color: #007BFF;
            transform: scale(1.05);
        }

        .instruction-button:active {
            transform: scale(0.95);
        }

        .choices-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .choice-button {
            background-color: #87CEEB;
            color: white;
            padding: 15px 10px;
            border: none;
            border-radius: 15px;
            font-size: 3em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            font-family: 'Fredoka One', cursive;
            letter-spacing: 1px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .choice-button:hover {
            background-color: #6495ED;
            transform: translateY(-3px);
        }

        .choice-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .choice-button.correct-feedback {
            background-color: #4CAF50;
            animation: correctPulse 0.5s forwards;
        }

        .choice-button.wrong-feedback {
            background-color: #F44336;
            animation: wrongShake 0.5s forwards;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wrongShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        #feedback {
            margin-top: 25px;
            font-size: 1.5em;
            font-weight: bold;
            min-height: 1.8em;
            transition: opacity 0.3s ease-in-out;
        }

        /* Gaya untuk pesan GAME SELESAI */
        .game-over-message {
            font-family: 'Fredoka One', cursive; /* Menggunakan font Fredoka One */
            color: #FF6347; /* Warna merah seperti judul utama */
            font-size: 3.5em; /* Ukuran lebih besar agar menarik */
            margin-top: 50px; /* Jarak dari atas */
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.15); /* Bayangan teks */
            animation: fadeInScale 1s ease-out forwards; /* Animasi muncul */
        }

        /* Gaya untuk teks Skor Akhir */
        .final-score-text {
            font-family: 'Fredoka One', cursive; /* Sesuaikan dengan tema */
            color: #4CAF50; /* Warna hijau untuk skor, atau bisa disesuaikan */
            font-size: 1.8em; /* Ukuran yang pas, di bawah "GAME SELESAI" */
            margin-top: 20px; /* Jarak dari "GAME SELESAI" */
            margin-bottom: 30px; /* Jarak dari tombol "Main Lagi" */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeInScale {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .main-button {
            background-color: #4CAF50; /* Hijau */
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.5em;
            font-family: 'Fredoka One', cursive;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }

        .main-button:hover {
            background-color: #45a049;
            transform: translateY(-3px);
        }

        .main-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }


        /* Responsif */
        @media (max-width: 768px) {
            .game-container {
                padding: 25px;
            }
            h1 {
                font-size: 2em;
            }
            .question-mark-display {
                font-size: 6em;
            }
            .choices-container {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }
            .choice-button {
                font-size: 2.5em;
                padding: 10px 5px;
            }
            .volume-control {
                top: 10px;
                right: 10px;
                flex-direction: column;
                align-items: flex-end;
            }
            .instructions-container {
                flex-direction: column;
                gap: 5px;
            }
            .game-over-message {
                font-size: 2.5em; /* Lebih kecil di mobile */
            }
            .final-score-text {
                font-size: 1.4em; /* Lebih kecil di mobile */
            }
            .main-button {
                font-size: 1.2em; /* Lebih kecil di mobile */
                padding: 12px 25px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="volume-control">
            <label for="volumeSlider">Musik:</label>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.3">
        </div>

        <div id="gameScreen">
            <h1>Tebak Suara Hewan! 🐾</h1>
            <div class="current-question-info" id="questionInfo">Pertanyaan 1 dari 10</div>
            <div class="score-display">Skor: <span id="score">0</span></div>
            <div class="question-mark-display" id="questionMarkDisplay">?</div>
            
            <div class="instructions-container">
                <p class="instructions-text" id="instructionsText">Klik tanda tanya untuk mendengar suaranya. Lalu, pilih emoji hewan yang benar!</p>
                <button class="instruction-button" id="playInstructionSound">🔊</button>
            </div>
            
            <div class="choices-container" id="choicesContainer">
                </div>
            <div id="feedback"></div>
        </div>

        <div id="gameOverScreen" style="display: none;">
            <div class="game-over-message" id="gameOverText">GAME SELESAI</div>
            <div class="final-score-text" id="finalScoreText"></div> <button class="main-button" onclick="playAgain()">Main Lagi!</button>
        </div>

    </div>

    <audio id="backgroundMusic" loop></audio>
    <audio id="gameSound"></audio>
    <audio id="feedbackSound"></audio>
    <audio id="clickEffectSound"></audio>
    <audio id="correctAnimalSound"></audio>

    <script>
        // ====================================================================
        // PANDUAN PEMELIHARAAN KODE
        // ====================================================================

        // --- 1. MENAMBAH/MENGUBAH HEWAN (PERTANYAAN) ---
        const animals = [
            { name: "singa", emoji: "🦁", sound: "assets/audio/lion.mp3", correctSound: "assets/audio/yabenar_singa.mp3" },
            { name: "anjing", emoji: "🐶", sound: "assets/audio/dog.mp3", correctSound: "assets/audio/yabenar_anjing.mp3" },
            { name: "kucing", emoji: "🐱", sound: "assets/audio/cat.mp3", correctSound: "assets/audio/yabenar_kucing.mp3" }, // <-- Pastikan ini .mp3
            { name: "gajah", emoji: "🐘", sound: "assets/audio/elephant.mp3", correctSound: "assets/audio/yabenar_gajah.mp3" },
            { name: "kambing", emoji: "🐐", sound: "assets/audio/goat.mp3", correctSound: "assets/audio/yabenar_kambing.mp3" },
            { name: "sapi", emoji: "🐄", sound: "assets/audio/cow.mp3", correctSound: "assets/audio/yabenar_sapi.mp3" },
            { name: "ayam", emoji: "🐔", sound: "assets/audio/chicken.mp3", correctSound: "assets/audio/yabenar_ayam.mp3" },
            { name: "kuda", emoji: "🐎", sound: "assets/audio/horse.mp3", correctSound: "assets/audio/yabenar_kuda.mp3" },
            { name: "monyet", emoji: "🐒", sound: "assets/audio/monkey.mp3", correctSound: "assets/audio/yabenar_monyet.mp3" },
            { name: "burung", emoji: "🐦", sound: "assets/audio/bird.mp3", correctSound: "assets/audio/yabenar_burung.mp3" }
            // CONTOH UNTUK MENAMBAH HEWAN BARU:
            // , { name: "bebek", emoji: "🦆", sound: "assets/audio/duck.mp3", correctSound: "assets/audio/yabenar_bebek.mp3" }
            // Pastikan Anda memiliki file: assets/audio/duck.mp3 dan assets/audio/yabenar_bebek.mp3
        ];

        // --- 2. MENGATUR JALUR SUARA GAME UTAMA DAN UMPAN BALIK ---
        const gameSounds = {
            backgroundMusic: "assets/audio/background_music.mp3",
            clickEffect: "assets/audio/click.mp3",
            instruction: "assets/audio/instruksi_tebak_suara.mp3", // Suara instruksi
            correctFeedback: "assets/audio/benar_sekali.mp3",
            wrongFeedback: "assets/audio/coba_lagi.mp3",
        };

        // --- 3. PENGATURAN DURASI SUARA DAN JEDA ---
        const ANIMAL_SOUND_DURATION = 2000; 
        const DELAY_AFTER_FEEDBACK = 4000; 
        const CLICK_EFFECT_DELAY = 500;

        // Variabel Status Game
        let currentQuestionIndex = 0;
        let score = 0;
        let choicesEnabled = true;
        let answeredQuestions = [];

        // Referensi Elemen HTML
        const questionMarkDisplayEl = document.getElementById('questionMarkDisplay');
        const backgroundMusicEl = document.getElementById('backgroundMusic');
        const gameSoundEl = document.getElementById('gameSound');
        const feedbackSoundEl = document.getElementById('feedbackSound');
        const clickEffectSoundEl = document.getElementById('clickEffectSound');
        const volumeSliderEl = document.getElementById('volumeSlider');
        const feedbackEl = document.getElementById('feedback');
        const scoreEl = document.getElementById('score');
        const choicesContainerEl = document.getElementById('choicesContainer');
        const instructionsTextEl = document.getElementById('instructionsText'); 
        const playInstructionSoundBtn = document.getElementById('playInstructionSound'); 
        const questionInfoEl = document.getElementById('questionInfo');
        const gameScreenEl = document.getElementById('gameScreen');
        const gameOverScreenEl = document.getElementById('gameOverScreen');
        const gameOverTextEl = document.getElementById('gameOverText');
        const finalScoreTextEl = document.getElementById('finalScoreText'); // Referensi elemen baru
        const correctAnimalSoundEl = document.getElementById('correctAnimalSound');


        // Fungsi Utilitas
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadNewQuestion() {
            if (currentQuestionIndex >= answeredQuestions.length) {
                displayGameCompleted();
                return;
            }

            choicesEnabled = true;
            feedbackEl.textContent = '';
            feedbackEl.className = '';

            const currentAnimal = answeredQuestions[currentQuestionIndex];
            questionMarkDisplayEl.textContent = '?';
            
            questionInfoEl.textContent = `Pertanyaan ${currentQuestionIndex + 1} dari ${answeredQuestions.length}`;

            generateChoices(currentAnimal);
        }

        function generateChoices(correctAnimal) {
            choicesContainerEl.innerHTML = '';

            let choiceAnimals = animals.filter(a => a.name !== correctAnimal.name);
            shuffleArray(choiceAnimals);

            const selectedWrongChoices = choiceAnimals.slice(0, Math.min(3, animals.length - 1));
            
            let choices = [...selectedWrongChoices, correctAnimal];
            shuffleArray(choices);

            choices.forEach(animal => {
                const button = document.createElement('button');
                button.textContent = animal.emoji;
                button.classList.add('choice-button');
                button.onclick = () => checkAnswer(animal, correctAnimal, button);
                choicesContainerEl.appendChild(button);
            });
        }

        function playAnimalSoundWithEffect() {
            clickEffectSoundEl.src = gameSounds.clickEffect;
            clickEffectSoundEl.play().catch(e => console.error("Error playing click sound:", e));

            questionMarkDisplayEl.style.transform = 'scale(1.1)';
            setTimeout(() => questionMarkDisplayEl.style.transform = 'scale(1)', 200);

            setTimeout(() => {
                const currentAnimal = answeredQuestions[currentQuestionIndex];
                gameSoundEl.src = currentAnimal.sound;
                gameSoundEl.play().catch(e => console.error("Error playing animal sound:", e));

                setTimeout(() => {
                    gameSoundEl.pause();
                    gameSoundEl.currentTime = 0;
                }, ANIMAL_SOUND_DURATION); 
            }, CLICK_EFFECT_DELAY);
        }

        async function checkAnswer(selectedAnimal, correctAnimal, clickedButton) {
            if (!choicesEnabled) return;

            choicesEnabled = false;

            const allButtons = choicesContainerEl.querySelectorAll('.choice-button');
            allButtons.forEach(btn => {
                btn.classList.remove('correct-feedback', 'wrong-feedback');
            });

            if (selectedAnimal.name === correctAnimal.name) {
                feedbackEl.textContent = 'Benar! 🎉';
                feedbackEl.classList.add('correct');
                
                correctAnimalSoundEl.src = correctAnimal.correctSound;
                await correctAnimalSoundEl.play().catch(e => console.error("Error playing correct animal sound:", e));

                feedbackSoundEl.src = gameSounds.correctFeedback;
                await feedbackSoundEl.play().catch(e => console.error("Error playing correct feedback sound:", e));
                
                clickedButton.classList.add('correct-feedback');
                score++;
                scoreEl.textContent = score;
                currentQuestionIndex++;

                setTimeout(() => {
                    loadNewQuestion();
                }, DELAY_AFTER_FEEDBACK); 
            } else {
                feedbackEl.textContent = `Salah. Jawaban yang benar adalah ${correctAnimal.name.charAt(0).toUpperCase() + correctAnimal.name.slice(1)}. 😞`;
                feedbackEl.classList.add('wrong');
                feedbackSoundEl.src = gameSounds.wrongFeedback;
                await feedbackSoundEl.play().catch(e => console.error("Error playing wrong feedback sound:", e));
                clickedButton.classList.add('wrong-feedback');

                allButtons.forEach(btn => {
                    if (btn.textContent === correctAnimal.emoji) {
                        btn.classList.add('correct-feedback');
                    }
                });
                currentQuestionIndex++;

                setTimeout(() => {
                    loadNewQuestion();
                }, DELAY_AFTER_FEEDBACK);
            }
        }

        function displayGameCompleted() {
            gameScreenEl.style.display = 'none'; // Sembunyikan layar game
            gameOverScreenEl.style.display = 'block'; // Tampilkan layar game over baru
            
            // Set teks skor akhir
            finalScoreTextEl.textContent = `Skor kamu ${score} dari ${animals.length} soal`;
            
            // Musik latar belakang akan tetap berjalan karena kita tidak mempause-nya di sini
            // backgroundMusicEl.play() // Tidak perlu dipanggil, karena sudah loop dan tidak dipause
        }

        function playAgain() {
            score = 0;
            scoreEl.textContent = score;
            currentQuestionIndex = 0;
            answeredQuestions = shuffleArray([...animals]);
            
            // Sembunyikan layar game over dan tampilkan kembali layar game utama
            gameOverScreenEl.style.display = 'none';
            gameScreenEl.style.display = 'block'; 
            
            // Reset tampilan elemen yang mungkin disembunyikan sebelumnya
            choicesContainerEl.style.display = 'grid';
            questionMarkDisplayEl.style.display = 'flex';
            instructionsTextEl.style.display = 'inline'; 
            playInstructionSoundBtn.style.display = 'inline-block'; 
            feedbackEl.innerHTML = ''; // Pastikan area feedback kosong
            
            // Pastikan musik latar belakang dimulai kembali jika sempat terhenti
            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed on playAgain:", e);
            });
            loadNewQuestion();
        }

        // Event listener untuk tanda tanya agar bisa diklik untuk memutar suara
        questionMarkDisplayEl.addEventListener('click', playAnimalSoundWithEffect);

        // Event listener untuk slider volume
        volumeSliderEl.addEventListener('input', (event) => {
            backgroundMusicEl.volume = event.target.value;
            gameSoundEl.volume = event.target.value;
            feedbackSoundEl.volume = event.target.value;
            clickEffectSoundEl.volume = event.target.value;
            correctAnimalSoundEl.volume = event.target.value;
        });

        // =========================================================
        // PENGATURAN AWAL GAME (Penting untuk Autoplay Musik)
        // =========================================================

        function tryPlayBackgroundMusic() {
            backgroundMusicEl.src = gameSounds.backgroundMusic;
            backgroundMusicEl.volume = 0.3;
            volumeSliderEl.value = 0.3;
            
            backgroundMusicEl.currentTime = 0; 

            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed:", e);
                document.body.addEventListener('click', enableBackgroundMusic, { once: true });
                document.body.addEventListener('touchend', enableBackgroundMusic, { once: true });
            });
        }

        function enableBackgroundMusic() {
            if (backgroundMusicEl.paused) {
                backgroundMusicEl.play().catch(e => {
                    console.error("Failed to play background music on user interaction:", e);
                });
            }
            document.body.removeEventListener('click', enableBackgroundMusic);
            document.body.removeEventListener('touchend', enableBackgroundMusic);
        }

        // --- MENGATUR TOMBOL SUARA INSTRUKSI ---
        function playInstructionSound() {
            gameSoundEl.src = gameSounds.instruction;
            gameSoundEl.play().catch(e => console.error("Error playing instruction sound:", e));
        }

        playInstructionSoundBtn.addEventListener('click', playInstructionSound);

        // Inisialisasi game saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            tryPlayBackgroundMusic();
            
            answeredQuestions = shuffleArray([...animals]); 
            loadNewQuestion();
        });
    </script>
</body>
</html>
