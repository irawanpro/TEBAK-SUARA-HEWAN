<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tebak Suara Hewan & Fakta Menarik!</title>
    <style>
        /* Desain Umum dan Font */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Open+Sans:wght@400;700&display=swap');

        body {
            font-family: 'Open Sans', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); /* Gradien cerah */
            color: #333;
            overflow-x: hidden; /* Mencegah scroll horizontal */
        }

        .game-container {
            background-color: #fff;
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            padding: 40px;
            text-align: center;
            max-width: 650px; /* Lebar lebih luas untuk fakta */
            width: 90%;
            transform: scale(0.95);
            animation: bounceIn 0.8s ease-out forwards;
            position: relative;
            overflow: hidden;
            border: 5px solid #FF6347; /* Border menarik */
            box-sizing: border-box; /* Pastikan padding masuk dalam lebar */
        }

        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        /* Hiasan Latar Belakang (Opsional) */
        .game-container::before, .game-container::after {
            content: '';
            position: absolute;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            filter: blur(20px);
            z-index: 0;
        }

        .game-container::before {
            width: 150px;
            height: 150px;
            top: -50px;
            left: -50px;
        }

        .game-container::after {
            width: 100px;
            height: 100px;
            bottom: -30px;
            right: -30px;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            color: #FF6347;
            margin-bottom: 25px;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .volume-control {
            position: absolute; /* Posisikan relatif terhadap game-container */
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 10; /* Pastikan di atas elemen lain */
        }

        .volume-control label {
            font-family: 'Fredoka One', cursive;
            font-size: 1.1em;
            color: #555;
        }

        .volume-control input[type="range"] {
            -webkit-appearance: none;
            width: 100px;
            height: 8px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }

        .volume-control input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .volume-control input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .current-question-info {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2em;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .score-display {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5em;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .question-mark-display {
            font-size: 8em; /* Ukuran tanda tanya besar */
            background-color: #333; /* Lingkaran hitam */
            color: white;
            border-radius: 50%;
            width: 1.5em; /* Membuatnya benar-benar lingkaran */
            height: 1.5em;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px auto; /* Tengah secara horizontal */
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            animation: pulse 1.5s infinite alternate; /* Animasi berdenyut */
            line-height: 1; /* Hapus spasi ekstra */
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        .question-mark-display:hover {
            transform: scale(1.1);
        }

        .instructions-container { /* Kontainer baru untuk teks dan tombol instruksi */
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            gap: 10px; /* Jarak antara teks dan tombol */
        }

        .instructions-text {
            font-style: italic;
            color: #555;
            font-size: 1.1em;
            margin: 0; /* Hapus margin default p */
        }

        .instruction-button {
            background-color: #1E90FF; /* Warna biru */
            color: white;
            border: none;
            border-radius: 50%; /* Bentuk lingkaran */
            width: 30px; /* Ukuran tombol */
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .instruction-button:hover {
            background-color: #007BFF;
            transform: scale(1.05);
        }

        .instruction-button:active {
            transform: scale(0.95);
        }


        .choices-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); /* Responsif, lebih kecil */
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .choice-button {
            background-color: #87CEEB; /* Biru langit */
            color: white; /* Warna font disesuaikan */
            padding: 15px 10px; /* Padding lebih kecil */
            border: none;
            border-radius: 15px;
            font-size: 3em; /* Ukuran emoji besar di tombol */
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            font-family: 'Fredoka One', cursive; /* Tetap pakai Fredoka untuk font emoji */
            letter-spacing: 1px;
            display: flex; /* Untuk tengah emoji */
            justify-content: center;
            align-items: center;
        }

        .choice-button:hover {
            background-color: #6495ED; /* Biru jagung */
            transform: translateY(-3px);
        }

        .choice-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .choice-button.correct-feedback {
            background-color: #4CAF50; /* Hijau untuk benar */
            animation: correctPulse 0.5s forwards;
        }

        .choice-button.wrong-feedback {
            background-color: #F44336; /* Merah untuk salah */
            animation: wrongShake 0.5s forwards;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wrongShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        #feedback {
            margin-top: 25px;
            font-size: 1.5em;
            font-weight: bold;
            min-height: 1.8em; /* Mencegah layout bergeser */
            transition: opacity 0.3s ease-in-out;
        }

        /* Bagian Hasil Akhir */
        .results-container {
            display: none; /* Sembunyikan secara default */
            padding: 20px;
            margin-top: 30px;
            border-top: 2px dashed #FF6347;
        }

        .results-container h2 {
            font-family: 'Fredoka One', cursive;
            color: #4CAF50;
            font-size: 2.2em;
            margin-bottom: 15px;
        }

        .fact-item {
            margin-bottom: 20px;
            text-align: left;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative; /* Penting untuk overflow */
        }

        .fact-item h3 {
            font-family: 'Fredoka One', cursive;
            color: #FFA500;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.6em;
            display: flex;
            align-items: center;
            gap: 10px;
            /* Perbaikan agar teks di h3 tidak terpotong */
            word-wrap: break-word; /* Memastikan kata panjang bisa pecah baris */
            overflow-wrap: break-word; /* Standar modern */
            max-width: calc(100% - 100px); /* Beri ruang untuk tombol Dengar Fakta */
            line-height: 1.2; /* Tingkatkan line-height jika perlu */
        }

        .fact-item h3 .fact-emoji {
            font-size: 1.2em;
            flex-shrink: 0; /* Pastikan emoji tidak menyusut */
        }

        .fact-item p {
            font-size: 1.1em;
            line-height: 1.6;
            color: #555;
            /* Pastikan paragraf tidak terpotong */
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .read-fact-button {
            background-color: #1E90FF; /* Biru dongker */
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            font-size: 0.9em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-left: auto; /* Dorong ke kanan */
            flex-shrink: 0; /* Pastikan tombol tidak menyusut */
        }

        .read-fact-button:hover {
            background-color: #007BFF;
        }

        /* Responsif */
        @media (max-width: 768px) {
            .game-container {
                padding: 25px;
            }
            h1 {
                font-size: 2em;
            }
            .question-mark-display {
                font-size: 6em;
            }
            .choices-container {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* Lebih rapat */
            }
            .choice-button {
                font-size: 2.5em; /* Emoji di tombol lebih kecil */
                padding: 10px 5px;
            }
            .fact-item h3 {
                font-size: 1.4em;
                max-width: calc(100% - 80px); /* Sesuaikan ruang tombol di mobile */
            }
            .fact-item p {
                font-size: 1em;
            }
            .volume-control {
                top: 10px;
                right: 10px;
                flex-direction: column; /* Vertikal di layar kecil */
                align-items: flex-end;
            }
            .instructions-container {
                flex-direction: column; /* Tumpuk vertikal di mobile */
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="volume-control">
            <label for="volumeSlider">Musik:</label>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.3">
        </div>

        <div id="gameScreen">
            <h1>Tebak Suara Hewan! 🐾</h1>
            <div class="current-question-info" id="questionInfo">Pertanyaan 1 dari 10</div>
            <div class="score-display">Skor: <span id="score">0</span></div>
            <div class="question-mark-display" id="questionMarkDisplay">?</div>
            
            <div class="instructions-container">
                <p class="instructions-text" id="instructionsText">Klik tanda tanya untuk mendengar suaranya. Lalu, pilih emoji hewan yang benar!</p>
                <button class="instruction-button" id="playInstructionSound">🔊</button>
            </div>
            
            <div class="choices-container" id="choicesContainer">
                </div>
            <div id="feedback"></div>
        </div>

        <div id="resultsScreen" class="results-container">
            <h2>🎉 Permainan Selesai! 🎉</h2>
            <p class="score-display">Skor Akhir Anda: <span id="finalScore">0</span> dari <span id="totalQuestions">0</span></p>
            <h3>Fakta Menarik tentang Hewan:</h3>
            <div id="factsContainer">
                </div>
            <div class="button-group">
                <button class="main-button" onclick="playAgain()">Main Lagi!</button>
            </div>
        </div>

    </div>

    <audio id="backgroundMusic" loop></audio>
    <audio id="gameSound"></audio>
    <audio id="feedbackSound"></audio>
    <audio id="factSound"></audio>
    <audio id="clickEffectSound"></audio>
    <audio id="correctAnimalSound"></audio>

    <script>
        // ====================================================================
        // PANDUAN PEMELIHARAAN KODE
        // ====================================================================

        // --- 1. MENAMBAH/MENGUBAH HEWAN (PERTANYAAN) DAN FAKTA ---
        const animals = [
            { name: "singa", emoji: "🦁", sound: "assets/audio/lion.mp3", fact: "Singa jantan punya surai lebat yang melindunginya saat berkelahi.", factSound: "assets/audio/fakta_singa.mp3", correctSound: "assets/audio/yabenar_singa.mp3" },
            { name: "anjing", emoji: "🐶", sound: "assets/audio/dog.mp3", fact: "Hidung anjing sangat sensitif, bisa mencium bau yang tidak terdeteksi manusia.", factSound: "assets/audio/fakta_anjing.mp3", correctSound: "assets/audio/yabenar_anjing.mp3" },
            { name: "kucing", emoji: "🐱", sound: "assets/audio/cat.mp3", fact: "Kucing bisa tidur 12 sampai 16 jam sehari!", factSound: "assets/audio/fakta_kucing.mp3", correctSound: "assets/audio/yabenar_kucing.mp3" },
            { name: "gajah", emoji: "🐘", sound: "assets/audio/elephant.mp3", fact: "Gajah adalah hewan darat terbesar dan menggunakan belalainya untuk minum dan makan.", factSound: "assets/audio/fakta_gajah.mp3", correctSound: "assets/audio/yabenar_gajah.mp3" },
            { name: "kambing", emoji: "🐐", sound: "assets/audio/goat.mp3", fact: "Kambing bisa memanjat pohon dan tebing curam dengan sangat lincah.", factSound: "assets/audio/fakta_kambing.mp3", correctSound: "assets/audio/yabenar_kambing.mp3" },
            { name: "sapi", emoji: "🐄", sound: "assets/audio/cow.mp3", fact: "Sapi punya empat perut dan menghabiskan sebagian besar waktunya mengunyah.", factSound: "assets/audio/fakta_sapi.mp3", correctSound: "assets/audio/yabenar_sapi.mp3" },
            { name: "ayam", emoji: "🐔", sound: "assets/audio/chicken.mp3", fact: "Ayam berkomunikasi dengan lebih dari 20 suara berbeda!", factSound: "assets/audio/fakta_ayam.mp3", correctSound: "assets/audio/yabenar_ayam.mp3" },
            { name: "kuda", emoji: "🐎", sound: "assets/audio/horse.mp3", fact: "Kuda bisa tidur sambil berdiri, tapi mereka juga butuh berbaring untuk tidur nyenyak.", factSound: "assets/audio/fakta_kuda.mp3", correctSound: "assets/audio/yabenar_kuda.mp3" },
            { name: "monyet", emoji: "🐒", sound: "assets/audio/monkey.mp3", fact: "Monyet menggunakan ekornya untuk menjaga keseimbangan dan bahkan memegang sesuatu.", factSound: "assets/audio/fakta_monyet.mp3", correctSound: "assets/audio/yabenar_monyet.mp3" },
            { name: "burung", emoji: "🐦", sound: "assets/audio/bird.mp3", fact: "Ada lebih dari 10.000 jenis burung di dunia!", factSound: "assets/audio/fakta_burung.mp3", correctSound: "assets/audio/yabenar_burung.mp3" }
            // CONTOH UNTUK MENAMBAH HEWAN BARU:
            // , { name: "bebek", emoji: "🦆", sound: "assets/audio/duck.mp3", fact: "Bebek punya kaki berselaput untuk berenang.", factSound: "assets/audio/fakta_bebek.mp3", correctSound: "assets/audio/yabenar_bebek.mp3" }
            // Pastikan Anda memiliki file: assets/audio/duck.mp3, assets/audio/fakta_bebek.mp3, dan assets/audio/yabenar_bebek.mp3
        ];

        // --- 2. MENGATUR JALUR SUARA GAME UTAMA DAN UMPAN BALIK ---
        const gameSounds = {
            backgroundMusic: "assets/audio/background_music.mp3",
            clickEffect: "assets/audio/click.mp3",
            instruction: "assets/audio/instruksi_tebak_suara.mp3", // Suara instruksi
            correctFeedback: "assets/audio/benar_sekali.mp3",
            wrongFeedback: "assets/audio/coba_lagi.mp3",
            scoreHigh: "assets/audio/skor_hebat.mp3",
            scoreMedium: "assets/audio/skor_lumayan.mp3",
            scoreLow: "assets/audio/skor_perlu_latihan.mp3"
        };

        // --- 3. PENGATURAN DURASI SUARA DAN JEDA ---
        // Perubahan Utama: Durasi suara tanda tanya menjadi 5 detik
        const QUESTION_SOUND_DURATION = 5000; // 5000ms = 5 detik
        const CLICK_EFFECT_DELAY = 500;

        // Variabel Status Game (JANGAN UBAH INI KECUALI ANDA PAHAM BETUL)
        let currentQuestionIndex = 0;
        let score = 0;
        let choicesEnabled = true;
        let answeredQuestions = [];

        // Referensi Elemen HTML (JANGAN UBAH INI KECUALI ANDA MENGUBAH ID HTML)
        const questionMarkDisplayEl = document.getElementById('questionMarkDisplay');
        const backgroundMusicEl = document.getElementById('backgroundMusic');
        const gameSoundEl = document.getElementById('gameSound');
        const feedbackSoundEl = document.getElementById('feedbackSound');
        const factSoundEl = document.getElementById('factSound');
        const clickEffectSoundEl = document.getElementById('clickEffectSound');
        const volumeSliderEl = document.getElementById('volumeSlider');
        const feedbackEl = document.getElementById('feedback');
        const scoreEl = document.getElementById('score');
        const choicesContainerEl = document.getElementById('choicesContainer');
        // --- Referensi Baru untuk Elemen Instruksi ---
        const instructionsTextEl = document.getElementById('instructionsText'); 
        const playInstructionSoundBtn = document.getElementById('playInstructionSound'); // Tombol instruksi
        // --- Akhir Referensi Baru ---
        const questionInfoEl = document.getElementById('questionInfo');
        const gameScreenEl = document.getElementById('gameScreen');
        const resultsScreenEl = document.getElementById('resultsScreen');
        const finalScoreEl = document.getElementById('finalScore');
        const totalQuestionsEl = document.getElementById('totalQuestions');
        const factsContainerEl = document.getElementById('factsContainer');
        // Tambahan referensi untuk elemen audio suara hewan yang benar
        const correctAnimalSoundEl = document.getElementById('correctAnimalSound');

        // Fungsi Utilitas (JANGAN UBAH INI KECUALI ANDA TAHU ALASANNYA)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadNewQuestion() {
            if (currentQuestionIndex >= answeredQuestions.length) {
                endGame();
                return;
            }

            choicesEnabled = true;
            feedbackEl.textContent = '';
            feedbackEl.className = '';

            const currentAnimal = answeredQuestions[currentQuestionIndex];
            questionMarkDisplayEl.textContent = '?';
            
            questionInfoEl.textContent = `Pertanyaan ${currentQuestionIndex + 1} dari ${answeredQuestions.length}`;

            generateChoices(currentAnimal);
        }

        // Perubahan Utama: Durasi suara gameSound (tanda tanya) diatur di sini
        function playAnimalSoundWithEffect() {
            clickEffectSoundEl.src = gameSounds.clickEffect;
            clickEffectSoundEl.play().catch(e => console.error("Error playing click sound:", e));

            questionMarkDisplayEl.style.transform = 'scale(1.1)';
            setTimeout(() => questionMarkDisplayEl.style.transform = 'scale(1)', 200);

            setTimeout(() => {
                const currentAnimal = answeredQuestions[currentQuestionIndex];
                gameSoundEl.src = currentAnimal.sound;
                gameSoundEl.play().catch(e => console.error("Error playing animal sound:", e));

                // Mengatur durasi suara agar berhenti setelah QUESTION_SOUND_DURATION (5 detik)
                setTimeout(() => {
                    gameSoundEl.pause();
                    gameSoundEl.currentTime = 0;
                }, QUESTION_SOUND_DURATION);

            }, CLICK_EFFECT_DELAY);
        }

        // Perubahan Utama: Penundaan transisi ke pertanyaan selanjutnya
        function checkAnswer(selectedAnimal, correctAnimal, clickedButton) {
            if (!choicesEnabled) return;

            choicesEnabled = false; // Nonaktifkan pilihan agar tidak bisa diklik lagi

            const allButtons = choicesContainerEl.querySelectorAll('.choice-button');
            allButtons.forEach(btn => {
                btn.classList.remove('correct-feedback', 'wrong-feedback');
            });

            if (selectedAnimal.name === correctAnimal.name) {
                feedbackEl.textContent = 'Benar! 🎉';
                feedbackEl.classList.add('correct');
                
                // Urutan: Putar suara hewan yang benar, lalu suara "benar sekali!"
                correctAnimalSoundEl.src = correctAnimal.correctSound;
                feedbackSoundEl.src = gameSounds.correctFeedback;

                correctAnimalSoundEl.play().then(() => {
                    // Setelah suara hewan benar selesai, putar suara "benar sekali!"
                    feedbackSoundEl.play().then(() => {
                        // Setelah kedua suara selesai, baru lanjut ke pertanyaan berikutnya
                        currentQuestionIndex++;
                        setTimeout(() => {
                            loadNewQuestion();
                        }, 500); // Jeda singkat sebelum memuat pertanyaan baru
                    }).catch(e => console.error("Error playing feedback sound after correct animal sound:", e));
                }).catch(e => console.error("Error playing correct animal sound:", e));
                
                clickedButton.classList.add('correct-feedback');
                score++;
                scoreEl.textContent = score;
            } else {
                feedbackEl.textContent = `Salah. Jawaban yang benar adalah ${correctAnimal.name.charAt(0).toUpperCase() + correctAnimal.name.slice(1)}. 😞`;
                feedbackEl.classList.add('wrong');
                feedbackSoundEl.src = gameSounds.wrongFeedback;
                feedbackSoundEl.play().catch(e => console.error("Error playing wrong feedback sound:", e));
                clickedButton.classList.add('wrong-feedback');

                allButtons.forEach(btn => {
                    if (btn.textContent === correctAnimal.emoji) {
                        btn.classList.add('correct-feedback');
                    }
                });
                currentQuestionIndex++;
                setTimeout(() => {
                    loadNewQuestion();
                }, 2500); // Jeda untuk jawaban salah tetap 2.5 detik
            }
        }

        // --- 5. LOGIKA AKHIR GAME DAN TAMPILAN FAKTA ---
        async function endGame() {
            backgroundMusicEl.pause();
            gameScreenEl.style.display = 'none';
            resultsScreenEl.style.display = 'block';

            finalScoreEl.textContent = score;
            totalQuestionsEl.textContent = animals.length;

            let scoreFeedbackSound;
            let scoreText;
            if (score === animals.length) {
                scoreFeedbackSound = gameSounds.scoreHigh;
                scoreText = `Hebat sekali! Kamu berhasil menjawab semua pertanyaan dengan benar!`;
            } else if (score >= animals.length / 2) {
                scoreFeedbackSound = gameSounds.scoreMedium;
                scoreText = `Kerja bagus! Kamu berhasil menjawab ${score} pertanyaan dengan benar. Terus berlatih ya!`;
            } else {
                scoreFeedbackSound = gameSounds.scoreLow;
                scoreText = `Jangan menyerah! Kamu sudah berusaha, mari kita belajar lagi.`;
            }
            feedbackEl.textContent = scoreText;
            feedbackEl.className = 'feedback-final-score';
            gameSoundEl.src = scoreFeedbackSound;
            await gameSoundEl.play().catch(e => console.error("Error playing score sound:", e));

            factsContainerEl.innerHTML = '';
            const shuffledFacts = shuffleArray([...animals]);

            for (const animal of shuffledFacts) {
                const factItem = document.createElement('div');
                factItem.classList.add('fact-item');
                factItem.innerHTML = `
                    <h3>
                        <span class="fact-emoji">${animal.emoji}</span> ${animal.name.charAt(0).toUpperCase() + animal.name.slice(1)}:
                        <button class="read-fact-button" data-sound="${animal.factSound}">Dengar Fakta</button>
                    </h3>
                    <p>${animal.fact}</p>
                `;
                factsContainerEl.appendChild(factItem);
            }

            const factButtons = document.querySelectorAll('.read-fact-button');
            factButtons.forEach(button => {
                button.addEventListener('click', () => {
                    factSoundEl.src = button.dataset.sound;
                    factSoundEl.play().catch(e => console.error("Error playing fact sound:", e));
                });
            });
        }

        function playAgain() {
            score = 0;
            scoreEl.textContent = score;
            currentQuestionIndex = 0;
            answeredQuestions = shuffleArray([...animals]);
            gameScreenEl.style.display = 'block';
            resultsScreenEl.style.display = 'none';
            
            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed on playAgain:", e);
            });
            loadNewQuestion();
        }

        // Event listener untuk tanda tanya agar bisa diklik untuk memutar suara
        questionMarkDisplayEl.addEventListener('click', playAnimalSoundWithEffect);

        // Event listener untuk slider volume
        volumeSliderEl.addEventListener('input', (event) => {
            backgroundMusicEl.volume = event.target.value;
            // Pastikan volume untuk semua audio lain juga disesuaikan jika diperlukan
            gameSoundEl.volume = event.target.value;
            feedbackSoundEl.volume = event.target.value;
            factSoundEl.volume = event.target.value;
            clickEffectSoundEl.volume = event.target.value;
            correctAnimalSoundEl.volume = event.target.value;
        });

        // =========================================================
        // PENGATURAN AWAL GAME (Penting untuk Autoplay Musik)
        // =========================================================

        function tryPlayBackgroundMusic() {
            backgroundMusicEl.src = gameSounds.backgroundMusic;
            backgroundMusicEl.volume = 0.3;
            volumeSliderEl.value = 0.3;
            
            backgroundMusicEl.currentTime = 0; 

            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed:", e);
                document.body.addEventListener('click', enableBackgroundMusic, { once: true });
                document.body.addEventListener('touchend', enableBackgroundMusic, { once: true });
            });
        }

        function enableBackgroundMusic() {
            if (backgroundMusicEl.paused) {
                backgroundMusicEl.play().catch(e => {
                    console.error("Failed to play background music on user interaction:", e);
                });
            }
            document.body.removeEventListener('click', enableBackgroundMusic);
            document.body.removeEventListener('touchend', enableBackgroundMusic);
        }

        // --- MENGATUR TOMBOL SUARA INSTRUKSI ---
        // Fungsi untuk memutar suara instruksi
        function playInstructionSound() {
            gameSoundEl.src = gameSounds.instruction;
            gameSoundEl.play().catch(e => console.error("Error playing instruction sound:", e));
        }

        // Event listener untuk tombol suara instruksi
        playInstructionSoundBtn.addEventListener('click', playInstructionSound);
        // --- Akhir Pengaturan Tombol Suara Instruksi ---


        // Inisialisasi game saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            tryPlayBackgroundMusic();
            
            answeredQuestions = shuffleArray([...animals]); 
            loadNewQuestion();
        });
    </script>
</body>
</html>
